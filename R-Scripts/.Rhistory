biocLite("SRAdb")
source("https://bioconductor.org/biocLite.R")
biocLite("SRAdb")
source("https://bioconductor.org/biocLite.R")
biocLite("SRAdb")
install.packages("Rcpp")
vignette("SRAdb")
install.packages("Rcurl")
install.packages("RCurl")
install.packages("Rcpp")
install.packages("tibble")
install.packages("XML")
install.packages("GEOquery")
biocLite("GEOquery")
source("https://bioconductor.org/biocLite.R")
biocLite("GEOquery")
vignette(GEOquery)
q()
load("~/Documentos/sradb/SRAmetadb.sqlite")
load("~/Documentos/sradb/SRAmetadb.sqlite.gz")
load("~/Documentos/sradb/SRAmetadb.sqlite")
load("~/Documentos/sradb/SRAmetadb.sqlite.gz")
library(SRAdb)
source("https://bioconductor.org/biocLite.R")
biocLite("BiocUpgrade")
installed.packages()
installed.packages(lib.loc = )
library(SRAdb)
sra_dbname <- 'SRAmetadb.sqlite'
R --vanilla
library(SRAdb)
biocLite("BiocUpgrade")
source("https://bioconductor.org/biocLite.R")
biocLite("BiocUpgrade")
ggplot(as.data.frame(UCBAdmissions),
aes(weight = Freq, axis1 = Gender, axis2 = Dept)) +
geom_alluvium(aes(fill = Admit), width = 1/12) +
geom_stratum(width = 1/12, fill = "black", color = "grey") +
geom_label(stat = "stratum", label.strata = TRUE) +
scale_x_continuous(breaks = 1:2, labels = c("Gender", "Dept")) +
ggtitle("UC Berkeley admissions and rejections, by sex and department")
library("ggplot")
library(ggplot2)
ggplot(as.data.frame(UCBAdmissions),
aes(weight = Freq, axis1 = Gender, axis2 = Dept)) +
geom_alluvium(aes(fill = Admit), width = 1/12) +
geom_stratum(width = 1/12, fill = "black", color = "grey") +
geom_label(stat = "stratum", label.strata = TRUE) +
scale_x_continuous(breaks = 1:2, labels = c("Gender", "Dept")) +
ggtitle("UC Berkeley admissions and rejections, by sex and department")
install.packages("ggalluvial")
library(alluvial)
help("alluvial")
vignette(alluvial)
vignette("alluvial")
setwd("~/Documentos/gits/GEO_project/R-Scripts/")
read.csv(file = "GEO_tablet.tsv", header = T, sep = '\t', na.strings = T, stringsAsFactors = F)
GEO<-read.csv(file = "GEO_tablet.tsv", header = T, sep = "\t", na.strings = "", stringsAsFactors = F)
Hs <- GEO[grep("Homo_sapiens", GEO$ORGANISMO), ]
Mm <- GEO [grep("Mus_musculus", GEO$ORGANISMO), ]
homo_musculus<- rbind(Hs, Mm)
rm(GEO)
FINAL_DF <-homo_musculus[0, ]
INTERMEDIATE_DF <- homo_musculus[0, ]
for(i in 1:nrow(homo_musculus)){
FINAL_DF <-homo_musculus[0, ]
INTERMEDIATE_DF <- homo_musculus[0, ]
message(paste0(Procesando la línea, i))
}
for(i in 1:nrow(homo_musculus)){
FINAL_DF <-homo_musculus[0, ]
INTERMEDIATE_DF <- homo_musculus[0, ]
message(paste0("Procesando la línea", i))
}
vocablos <- c("addiction", "brain", "coccaine", "alcohol")
vocablos <- c("addiction", "brain", "coccaine", "alcohol")
for (i in 1:nrow(Hs)){
result1<-grep(vocablos, i)
}
for (i in 1:nrow(Hs)){
result1<-data.frame(grep(vocablos, i, fixed = T))
}
for (i in 1:nrow(Hs)){
message(paste0("operando sobre la línea", i))
result1<-data.frame(grep(vocablos, i, fixed = T))
}
View(result1)
for (i in 1:nrow(Hs)){
message(paste0("operando sobre la línea", i))
result0 <- Hs[0,]
result1<-data.frame(grepl(vocablos, i, fixed = T))
}
View(result0)
for (i in vocablos){
r3<-dataframe(grep(i, Hs$RESUMEN_DEL_PROYECTO))
}
for (i in vocablos){
r3<-data.frame(grep(i, Hs$RESUMEN_DEL_PROYECTO))
}
View(r3)
for (i in vocablos){
r3<-data.frame(grep(i, Hs$RESUMEN_DEL_PROYECTO, value = T))
}
vocablos<- c("addiction", "Alcoholism", "OCD", "Brain", "coccaine", "drug_abuse", "alcohol", "reward", "substance_related_disorders", "neuroscience", "dopamine", "glutamate", "reward_mechanisms", "alcohol_dependence", "DDR")
vocablos <- c("addiction", "Alcoholism", "OCD", "Brain", "coccaine", "drug_abuse", "alcohol",
"reward", "substance_related_disorders", "neuroscience", "dopamine", "glutamate",
"reward_mechanisms", "alcohol_dependence", "DDR")
for (i in vocablos){
message(paste0("Operando sobre la línea", i))
r3<-data.frame(grep(i, Hs$RESUMEN_DEL_PROYECTO, value = T))
}
for (i in vocablos){
message(paste0("Operando sobre la línea ", i))
r3<-data.frame(grep(i, Hs$RESUMEN_DEL_PROYECTO, value = T))
}
View(r3)
for (i in vocablos){
message(paste0("Operando sobre la línea ", i))
r3<-Hs[grep(i, Hs$RESUMEN_DEL_PROYECTO, value = T), ]
}
View(r3)
for (i in vocablos){
message(paste0("Operando sobre la línea ", i))
r3<-Hs[grep(i, Hs$RESUMEN_DEL_PROYECTO), ]
}
View(r3)
for (i in vocablos){
message(paste0("Operando sobre la línea ", i))
r3<-Hs[grep(i, Hs$RESUMEN_DEL_PROYECTO), ]
r3<- grep("cancer", r3, invert = T)
}
for (i in vocablos){
message(paste0("Operando sobre la línea ", i))
r3<-Hs[grep(i, Hs$RESUMEN_DEL_PROYECTO), ]
r3<--Hs[grep("cancer", Hs$RESUMEN_DEL_PROYECTO, invert = T), ]
}
for (i in vocablos){
message(paste0("Operando sobre la línea ", i))
r3<-Hs[grep(i, Hs$RESUMEN_DEL_PROYECTO), ]
r3<--r3[grep("cancer", r3$RESUMEN_DEL_PROYECTO, invert = T), ]
}
for (i in vocablos){
message(paste0("Operando sobre la línea ", i))
r3<-Hs[grep(i, Hs$RESUMEN_DEL_PROYECTO), ]
r4<--r3[grep("cancer", r3$RESUMEN_DEL_PROYECTO, invert = T), ]
}
for (i in vocablos){
message(paste0("Operando sobre la línea ", i))
r3<-Hs[grep(i, Hs$RESUMEN_DEL_PROYECTO), ]
#r4<--r3[grep("cancer", r3$RESUMEN_DEL_PROYECTO, invert = T), ]
}
for (i in vocablos){
message(paste0("Operando sobre la línea ", i))
r3<-Hs[grep(i, Hs$RESUMEN_DEL_PROYECTO), ]
r3<-r3[grep("cancer", r3$RESUMEN_DEL_PROYECTO, invert = T), ]
}
View(r3)
GEO<-read.csv(file="GEO_tablet.tsv", header = T, sep = "\t", na.strings = "", stringsAsFactors = F)
rm(GEO)
a<-Hs[grep("addiction", Hs$RESUMEN_DEL_PROYECTO), ]
b<-Hs[grep("Alcoholism", Hs$RESUMEN_DEL_PROYECTO), ]
c<-Hs[grep("OCD", Hs$RESUMEN_DEL_PROYECTO), ]
d<-Hs[grep("Brain", Hs$RESUMEN_DEL_PROYECTO), ]
e<-Hs[grep("Coccaine", Hs$RESUMEN_DEL_PROYECTO), ]
f<-Hs[grep("Drug_abuse", Hs$RESUMEN_DEL_PROYECTO), ]
g<-Hs[grep("Alcohol", Hs$RESUMEN_DEL_PROYECTO), ]
h<-Hs[grep("Reward", Hs$RESUMEN_DEL_PROYECTO), ]
i<-Hs[grep("Substance_related_disorders", Hs$RESUMEN_DEL_PROYECTO), ]
j<-Hs[grep("Neuroscience", Hs$RESUMEN_DEL_PROYECTO), ]
k<-Hs[grep("Dopamine", Hs$RESUMEN_DEL_PROYECTO), ]
l<-Hs[grep("Glutamate", Hs$RESUMEN_DEL_PROYECTO), ]
m<-Hs[grep("Reward_mechanisms", Hs$RESUMEN_DEL_PROYECTO), ]
n<-Hs[grep("Alcohol_dependence", Hs$RESUMEN_DEL_PROYECTO), ]
dflist<- list(a,b,c,d,e,f,g,h,i,j,k,l,m,n)
semifinal <- do.call("rbind", dflist)
final.geo<-semifinal[!grepl("cancer", semifinal$RESUMEN_DEL_PROYECTO), ]
rm(a,b,c,d,e,f,g,h,i,j,k,l,m,n, semifinal, dflist, GEO)
AvsB<-data.frame(final.geo$GEO_ID, r3$GEO_ID)
AvsB<-data.frame(final.geo$GEO_ID, r3$GEO_ID)
AvsB<-table(final.geo$GEO_ID, r3$GEO_ID)
A<- final.geo$GEO_ID
B<- r3$GEO_ID
n<-max(length(A), length(B))
n
AvsBcbind(A, B)
AvsB<-cbind(A, B)
A
B
A<-length(n)
B<-length(n)
AvsB<-cbind()
AvsB<-cbind(A,B)
View(AvsB)
A<- final.geo$GEO_ID
B<- r3$GEO_ID
n<-max(length(A), length(B))
length(A)<- n
length(B)<- n
AvsB<-cbind(A,B)
View(AvsB)
ORGANISMO<-unlist(strsplit(CELDA, split = ","))
CELDA<-homo_musculus$ORGANISMO[3]
CELDA
CELDA<-homo_musculus$ORGANISMO[33]
CELDA
ORGANISMO<-unlist(strsplit(CELDA, split = ","))
ORGANISMO
strsplit(CELDA, split = ",")
for(i in 1:nrow(homo_musculus)){
FINAL_DF <-homo_musculus[0, ]
INTERMEDIATE_DF <- homo_musculus[0, ]
message(paste0("Procesando la línea", i))
CELDA<-homo_musculus$ORGANISMO[33]
ESPECIES<-unlist(strsplit(CELDA, split = ","))
ESPECIES <- ESPECIES[!grepl('!Sample', ESPECIES)]
ESPECIES <- ESPECIES [!grepl('1:9', ESPECIES)]
NUMERO_DE_ESPECIES <- length(ESPECIES)
for(x in 1:NUMERO_DE_ESPECIES){
INTERMEDIATE_DF[x,] <-homo_musculus[i,]
INTERMEDIATE.DATAFRAME[x,"ORGANISMO"] <- ESPECIES[x]
}
rbind(FINAL_DF, INTERMEDIATE_DF)
}
for(i in 1:nrow(homo_musculus)){
FINAL_DF <-homo_musculus[0, ]
INTERMEDIATE_DF <- homo_musculus[0, ]
message(paste0("Procesando la línea", i))
CELDA<-homo_musculus$ORGANISMO[33]
ESPECIES<-unlist(strsplit(CELDA, split = ","))
ESPECIES <- ESPECIES[!grepl('!Sample', ESPECIES)]
ESPECIES <- ESPECIES [!grepl('1:9', ESPECIES)]
NUMERO_DE_ESPECIES <- length(ESPECIES)
for(x in 1:NUMERO_DE_ESPECIES){
INTERMEDIATE_DF[x,] <-homo_musculus[i,]
INTERMEDIATE_DF[x,"ORGANISMO"] <- ESPECIES[x]
}
rbind(FINAL_DF, INTERMEDIATE_DF)
}
rm(INTERMEDIATE_DF)
FINAL_DF <-homo_musculus[0, ]
INTERMEDIATE_DF <- homo_musculus[0, ]
for(i in 1:nrow(homo_musculus)){
message(paste0("Procesando la línea", i))
CELDA<-homo_musculus$ORGANISMO[33]
ESPECIES<-unlist(strsplit(CELDA, split = ","))
ESPECIES <- ESPECIES[!grepl('!Sample', ESPECIES)]
ESPECIES <- ESPECIES [!grepl('1:9', ESPECIES)]
NUMERO_DE_ESPECIES <- length(ESPECIES)
for(x in 1:NUMERO_DE_ESPECIES){
INTERMEDIATE_DF[x,] <-homo_musculus[i,]
INTERMEDIATE_DF[x,"ORGANISMO"] <- ESPECIES[x]
}
rbind(FINAL_DF, INTERMEDIATE_DF)
rm(INTERMEDIATE_DF)
}
INTERMEDIATE_DF <- homo_musculus[0, ]
for(i in 1:nrow(homo_musculus)){
message(paste0("Procesando la línea", i))
CELDA<-homo_musculus$ORGANISMO[33]
ESPECIES<-unlist(strsplit(CELDA, split = ","))
ESPECIES <- ESPECIES[!grepl('!Sample', ESPECIES)]
ESPECIES <- ESPECIES [!grepl('1:9', ESPECIES)]
NUMERO_DE_ESPECIES <- length(ESPECIES)
for(x in 1:NUMERO_DE_ESPECIES){
INTERMEDIATE_DF[x,] <-homo_musculus[i,]
INTERMEDIATE_DF[x,"ORGANISMO"] <- ESPECIES[x]
}
rbind(FINAL_DF, INTERMEDIATE_DF)
rm(INTERMEDIATE_DF)
}
FINAL_DF <-homo_musculus[0, ]
INTERMEDIATE_DF <- homo_musculus[0, ]
for(i in 1:nrow(homo_musculus)){
message(paste0("Procesando la línea", i))
CELDA<-homo_musculus$ORGANISMO[33]
ESPECIES<-unlist(strsplit(CELDA, split = ","))
ESPECIES <- ESPECIES[!grepl('!Sample', ESPECIES)]
ESPECIES <- ESPECIES [!grepl('1:9', ESPECIES)]
NUMERO_DE_ESPECIES <- length(ESPECIES)
for(x in 1:NUMERO_DE_ESPECIES){
INTERMEDIATE_DF[x,] <-homo_musculus[i,]
INTERMEDIATE_DF[x,"ORGANISMO"] <- ESPECIES[x]
}
rbind(FINAL_DF, INTERMEDIATE_DF)
rm(INTERMEDIATE_DF)
}
for(i in 1:nrow(homo_musculus)){
message(paste0("Procesando la línea", i))
CELDA<-homo_musculus$ORGANISMO[33]
ESPECIES<-unlist(strsplit(CELDA, split = ","))
ESPECIES <- ESPECIES[!grepl('!Sample', ESPECIES)]
ESPECIES <- ESPECIES [!grepl('1:9', ESPECIES)]
NUMERO_DE_ESPECIES <- length(ESPECIES)
for(x in 1:NUMERO_DE_ESPECIES){
INTERMEDIATE_DF[x,] <-homo_musculus[i,]
INTERMEDIATE_DF[x,"ORGANISMO"] <- ESPECIES[x]
}
rbind(FINAL_DF, INTERMEDIATE_DF)
}
FINAL_DF <-homo_musculus[0, ]
INTERMEDIATE_DF <- homo_musculus[0, ]
for(i in 1:nrow(homo_musculus)){
message(paste0("Procesando la línea", i))
CELDA<-homo_musculus$ORGANISMO[33]
ESPECIES<-unlist(strsplit(CELDA, split = ","))
ESPECIES <- ESPECIES[!grepl('!Sample', ESPECIES)]
ESPECIES <- ESPECIES [!grepl('1:9', ESPECIES)]
NUMERO_DE_ESPECIES <- length(ESPECIES)
for(x in 1:NUMERO_DE_ESPECIES){
INTERMEDIATE_DF[x,] <-homo_musculus[i,]
INTERMEDIATE_DF[x,"ORGANISMO"] <- ESPECIES[x]
}
rbind(FINAL_DF, INTERMEDIATE_DF)
}
for(i in 1:nrow(homo_musculus)){
message(paste0("Procesando la línea", i))
CELDA<-homo_musculus$ORGANISMO[33]
ESPECIES<-unlist(strsplit(CELDA, split = ","))
ESPECIES <- ESPECIES[!grepl('!Sample', ESPECIES)]
ESPECIES <- ESPECIES [!grepl('1:9', ESPECIES)]
NUMERO_DE_ESPECIES <- length(ESPECIES)
for(x in 1:NUMERO_DE_ESPECIES){
INTERMEDIATE_DF[x,] <-homo_musculus[i,]
INTERMEDIATE_DF[x,"ORGANISMO"] <- ESPECIES[x]
}
FINAL_DF<-rbind(FINAL_DF, INTERMEDIATE_DF)
}
View(FINAL_DF)
View(FINAL_DF)
