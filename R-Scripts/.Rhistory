biocLite("SRAdb")
source("https://bioconductor.org/biocLite.R")
biocLite("SRAdb")
source("https://bioconductor.org/biocLite.R")
biocLite("SRAdb")
install.packages("Rcpp")
vignette("SRAdb")
install.packages("Rcurl")
install.packages("RCurl")
install.packages("Rcpp")
install.packages("tibble")
install.packages("XML")
install.packages("GEOquery")
biocLite("GEOquery")
source("https://bioconductor.org/biocLite.R")
biocLite("GEOquery")
vignette(GEOquery)
q()
load("~/Documentos/sradb/SRAmetadb.sqlite")
load("~/Documentos/sradb/SRAmetadb.sqlite.gz")
load("~/Documentos/sradb/SRAmetadb.sqlite")
load("~/Documentos/sradb/SRAmetadb.sqlite.gz")
library(SRAdb)
source("https://bioconductor.org/biocLite.R")
biocLite("BiocUpgrade")
installed.packages()
installed.packages(lib.loc = )
library(SRAdb)
sra_dbname <- 'SRAmetadb.sqlite'
R --vanilla
library(SRAdb)
biocLite("BiocUpgrade")
source("https://bioconductor.org/biocLite.R")
biocLite("BiocUpgrade")
ggplot(as.data.frame(UCBAdmissions),
aes(weight = Freq, axis1 = Gender, axis2 = Dept)) +
geom_alluvium(aes(fill = Admit), width = 1/12) +
geom_stratum(width = 1/12, fill = "black", color = "grey") +
geom_label(stat = "stratum", label.strata = TRUE) +
scale_x_continuous(breaks = 1:2, labels = c("Gender", "Dept")) +
ggtitle("UC Berkeley admissions and rejections, by sex and department")
library("ggplot")
library(ggplot2)
ggplot(as.data.frame(UCBAdmissions),
aes(weight = Freq, axis1 = Gender, axis2 = Dept)) +
geom_alluvium(aes(fill = Admit), width = 1/12) +
geom_stratum(width = 1/12, fill = "black", color = "grey") +
geom_label(stat = "stratum", label.strata = TRUE) +
scale_x_continuous(breaks = 1:2, labels = c("Gender", "Dept")) +
ggtitle("UC Berkeley admissions and rejections, by sex and department")
install.packages("ggalluvial")
library(alluvial)
help("alluvial")
vignette(alluvial)
vignette("alluvial")
library(ggplot2)
setwd("Documentos/gits/GEO_project/R-Scripts/")
GEO<-read.csv(file="GEO_tablet.tsv", header = T, sep = "\t", na.strings = "", stringsAsFactors = F)
Hs<- GEO[grep("Homo_sapiens", GEO$ORGANISMO), ]
a<-Hs[grep("addiction", Hs$RESUMEN_DEL_PROYECTO), ]
b<-Hs[grep("Alcoholism", Hs$RESUMEN_DEL_PROYECTO), ]
c<-Hs[grep("OCD", Hs$RESUMEN_DEL_PROYECTO), ]
d<-Hs[grep("Brain", Hs$RESUMEN_DEL_PROYECTO), ]
e<-Hs[grep("Coccaine", Hs$RESUMEN_DEL_PROYECTO), ]
f<-Hs[grep("Drug_abuse", Hs$RESUMEN_DEL_PROYECTO), ]
g<-Hs[grep("Alcohol", Hs$RESUMEN_DEL_PROYECTO), ]
h<-Hs[grep("Reward", Hs$RESUMEN_DEL_PROYECTO), ]
i<-Hs[grep("Substance_related_disorders", Hs$RESUMEN_DEL_PROYECTO), ]
j<-Hs[grep("Neuroscience", Hs$RESUMEN_DEL_PROYECTO), ]
k<-Hs[grep("Dopamine", Hs$RESUMEN_DEL_PROYECTO), ]
l<-Hs[grep("Glutamate", Hs$RESUMEN_DEL_PROYECTO), ]
m<-Hs[grep("Reward_mechanisms", Hs$RESUMEN_DEL_PROYECTO), ]
n<-Hs[grep("Alcohol_dependence", Hs$RESUMEN_DEL_PROYECTO), ]
dflist<- list(a,b,c,d,e,f,g,h,i,j,k,l,m,n)
semifinal <- do.call("rbind", dflist)
final.geo<-semifinal[!grepl("cancer", semifinal$RESUMEN_DEL_PROYECTO), ]
rm(a,b,c,d,e,f,g,h,i,j,k,l,m,n, semifinal, dflist)
tit <- as.data.frame(Titanic, stringsAsFactors = FALSE)
library("alluvial")
alluvial(tit[,1:4], freq=tit$Freq,
col = ifelse(tit$Survived == "Yes", "orange", "grey"),
border = ifelse(tit$Survived == "Yes", "orange", "grey"),
hide = tit$Freq == 0,
cex = 0.7
)
vignette("alluvial")
Hs$SAMPLE_DESCRIPTION
View(Hs$SAMPLE_DESCRIPTION)
View(as.data.frame(Hs$SAMPLE_DESCRIPTION))
View(as.data.frame(final.geo$SAMPLE_DESCRIPTION))
View(final.geo)
a<-Hs[grep("addiction", Hs$RESUMEN_DEL_PROYECTO), ]
b<-Hs[grep("Alcoholism", Hs$RESUMEN_DEL_PROYECTO), ]
c<-Hs[grep("OCD", Hs$RESUMEN_DEL_PROYECTO), ]
d<-Hs[grep("Brain", Hs$RESUMEN_DEL_PROYECTO), ]
e<-Hs[grep("Coccaine", Hs$RESUMEN_DEL_PROYECTO), ]
f<-Hs[grep("Drug_abuse", Hs$RESUMEN_DEL_PROYECTO), ]
g<-Hs[grep("Alcohol", Hs$RESUMEN_DEL_PROYECTO), ]
h<-Hs[grep("Reward", Hs$RESUMEN_DEL_PROYECTO), ]
i<-Hs[grep("Substance_related_disorders", Hs$RESUMEN_DEL_PROYECTO), ]
j<-Hs[grep("Neuroscience", Hs$RESUMEN_DEL_PROYECTO), ]
k<-Hs[grep("Dopamine", Hs$RESUMEN_DEL_PROYECTO), ]
l<-Hs[grep("Glutamate", Hs$RESUMEN_DEL_PROYECTO), ]
m<-Hs[grep("Reward_mechanisms", Hs$RESUMEN_DEL_PROYECTO), ]
n<-Hs[grep("Alcohol_dependence", Hs$RESUMEN_DEL_PROYECTO), ]
dflist<- list(a,b,c,d,e,f,g,h,i,j,k,l,m,n)
semifinal <- do.call("rbind", dflist)
final.geo<-semifinal[!grepl("Cancer", semifinal$RESUMEN_DEL_PROYECTO), ]
final.geo<-semifinal[!grepl("cancer", semifinal$RESUMEN_DEL_PROYECTO), ]
a<-Hs[grep("addiction", Hs$RESUMEN_DEL_PROYECTO), ]
b<-Hs[grep("Alcoholism", Hs$RESUMEN_DEL_PROYECTO), ]
c<-Hs[grep("OCD", Hs$RESUMEN_DEL_PROYECTO), ]
d<-Hs[grep("Brain", Hs$RESUMEN_DEL_PROYECTO), ]
e<-Hs[grep("Coccaine", Hs$RESUMEN_DEL_PROYECTO), ]
f<-Hs[grep("Drug_abuse", Hs$RESUMEN_DEL_PROYECTO), ]
g<-Hs[grep("Alcohol", Hs$RESUMEN_DEL_PROYECTO), ]
h<-Hs[grep("Reward", Hs$RESUMEN_DEL_PROYECTO), ]
i<-Hs[grep("Substance_related_disorders", Hs$RESUMEN_DEL_PROYECTO), ]
j<-Hs[grep("Neuroscience", Hs$RESUMEN_DEL_PROYECTO), ]
k<-Hs[grep("Dopamine", Hs$RESUMEN_DEL_PROYECTO), ]
l<-Hs[grep("Glutamate", Hs$RESUMEN_DEL_PROYECTO), ]
m<-Hs[grep("Reward_mechanisms", Hs$RESUMEN_DEL_PROYECTO), ]
n<-Hs[grep("Alcohol_dependence", Hs$RESUMEN_DEL_PROYECTO), ]
dflist<- list(a,b,c,d,e,f,g,h,i,j,k,l,m,n)
semifinal <- do.call("rbind", dflist)
final.geo<-semifinal[!grepl("cancer", semifinal$RESUMEN_DEL_PROYECTO), ]
GEO<-read.csv(file="GEO_tablet.tsv", header = T, sep = "\t", na.strings = "", stringsAsFactors = F)
Hs<- GEO[grep("Homo_sapiens", GEO$ORGANISMO), ]
a<-Hs[grep("addiction", Hs$RESUMEN_DEL_PROYECTO), ]
b<-Hs[grep("Alcoholism", Hs$RESUMEN_DEL_PROYECTO), ]
c<-Hs[grep("OCD", Hs$RESUMEN_DEL_PROYECTO), ]
d<-Hs[grep("Brain", Hs$RESUMEN_DEL_PROYECTO), ]
e<-Hs[grep("Coccaine", Hs$RESUMEN_DEL_PROYECTO), ]
f<-Hs[grep("Drug_abuse", Hs$RESUMEN_DEL_PROYECTO), ]
g<-Hs[grep("Alcohol", Hs$RESUMEN_DEL_PROYECTO), ]
h<-Hs[grep("Reward", Hs$RESUMEN_DEL_PROYECTO), ]
i<-Hs[grep("Substance_related_disorders", Hs$RESUMEN_DEL_PROYECTO), ]
j<-Hs[grep("Neuroscience", Hs$RESUMEN_DEL_PROYECTO), ]
k<-Hs[grep("Dopamine", Hs$RESUMEN_DEL_PROYECTO), ]
l<-Hs[grep("Glutamate", Hs$RESUMEN_DEL_PROYECTO), ]
m<-Hs[grep("Reward_mechanisms", Hs$RESUMEN_DEL_PROYECTO), ]
n<-Hs[grep("Alcohol_dependence", Hs$RESUMEN_DEL_PROYECTO), ]
dflist<- list(a,b,c,d,e,f,g,h,i,j,k,l,m,n)
semifinal <- do.call("rbind", dflist)
final.geo<-semifinal[!grepl("cancer", semifinal$RESUMEN_DEL_PROYECTO), ]
final.geo<-semifinal[!grepl("Cancer", semifinal$RESUMEN_DEL_PROYECTO), ]
rm(a,b,c,d,e,f,g,h,i,j,k,l,m,n, semifinal, dflist)
tit %>% group_by(Class, Survived) %>%
summarise(n = sum(Freq)) -> tit2d
alluvial(tit2d[,1:2], freq=tit2d$n)
tit %>% group_by(Class, Survived) %>% summarise(n = sum(Freq)) -> tit2d
tit > group_by(Class, Survived) > summarise(n = sum(Freq)) -> tit2d
tit -> group_by(Class, Survived) -> summarise(n = sum(Freq)) -> tit2d
tit <- as.data.frame(Titanic, stringsAsFactors = FALSE)
tit -> group_by(Class, Survived) -> summarise(n = sum(Freq)) -> tit2d
vignette("alluvial")
help(group_by)
help('group_by')
??group_by
help("group_by")
library("dplyr")
tit %>% group_by(Class, Survived) %>%
summarise(n = sum(Freq)) -> tit2d
alluvial(tit2d[,1:2], freq=tit2d$n)
tit2d
View(final.geo)
help("dplyr")
View(final.geo)
Tipo_de_experimento <- as.vector(study_type$series_type)
Freq<- study_type$Freq
series_type <- as.vector(study_type$series_type)
study_type <- data.frame(series_type, Freq)
porcentaje <- percent(Freq/sum(Freq))
bp <- ggplot(study_type, aes(x="", y=study_type$Freq, fill= study_type$series_type)) +
geom_bar(stat = "identity", width = 0.3) + scale_fill_brewer(palette = "Dark2")
bp + geom_text( check_overlap = F)
bp <- ggplot(study_type, aes(x="", y=study_type$Freq, fill= study_type$series_type)) +
geom_bar(stat = "identity", width = 0.3) + scale_fill_brewer(palette = "Dark2")
bp + geom_text( check_overlap = F)
study_type<- table(final.geo$SERIES_TYPE)
study_type<- data.frame(study_type, stringsAsFactors = F)
names(study_type)[1] <-"series_type"
otrosdf<- data.frame(series_type = "Otros", Freq = sum(study_type == 1))
study_type <- data.frame(study_type[study_type$Freq >= 2, ])
study_type <- rbind(study_type, otrosdf)
study_type <- study_type[order(study_type$Freq, decreasing = F), ]
labls <- study_type$series_type
study_type<-study_type[order(study_type$Freq, decreasing = T), ]
library(ggplot2)
library(scales)
library(plyr)
Tipo_de_experimento <- as.vector(study_type$series_type)
Freq<- study_type$Freq
series_type <- as.vector(study_type$series_type)
study_type <- data.frame(series_type, Freq)
porcentaje <- percent(Freq/sum(Freq))
bp <- ggplot(study_type, aes(x="", y=study_type$Freq, fill= study_type$series_type)) +
geom_bar(stat = "identity", width = 0.3) + scale_fill_brewer(palette = "Dark2")
bp + geom_text( check_overlap = F)
bp <- ggplot(study_type, aes(x="", y=study_type$Freq, fill= study_type$series_type)) +
geom_bar(stat = "identity", width = 0.3) + scale_fill_brewer(palette = "Dark2")
bp
study_type
setwd("Documentos/gits/GEO_project/R-Scripts/")
GEO<-read.csv(file="GEO_tablet.tsv", header = T, sep = "\t", na.strings = "", stringsAsFactors = F)
Hs<- GEO[grep("Homo_sapiens", GEO$ORGANISMO), ]
a<-Hs[grep("addiction", Hs$RESUMEN_DEL_PROYECTO), ]
b<-Hs[grep("Alcoholism", Hs$RESUMEN_DEL_PROYECTO), ]
c<-Hs[grep("OCD", Hs$RESUMEN_DEL_PROYECTO), ]
d<-Hs[grep("Brain", Hs$RESUMEN_DEL_PROYECTO), ]
e<-Hs[grep("Coccaine", Hs$RESUMEN_DEL_PROYECTO), ]
f<-Hs[grep("Drug_abuse", Hs$RESUMEN_DEL_PROYECTO), ]
g<-Hs[grep("Alcohol", Hs$RESUMEN_DEL_PROYECTO), ]
h<-Hs[grep("Reward", Hs$RESUMEN_DEL_PROYECTO), ]
i<-Hs[grep("Substance_related_disorders", Hs$RESUMEN_DEL_PROYECTO), ]
j<-Hs[grep("Neuroscience", Hs$RESUMEN_DEL_PROYECTO), ]
k<-Hs[grep("Dopamine", Hs$RESUMEN_DEL_PROYECTO), ]
l<-Hs[grep("Glutamate", Hs$RESUMEN_DEL_PROYECTO), ]
m<-Hs[grep("Reward_mechanisms", Hs$RESUMEN_DEL_PROYECTO), ]
n<-Hs[grep("Alcohol_dependence", Hs$RESUMEN_DEL_PROYECTO), ]
dflist<- list(a,b,c,d,e,f,g,h,i,j,k,l,m,n)
semifinal <- do.call("rbind", dflist)
final.geo<-semifinal[!grepl("cancer", semifinal$RESUMEN_DEL_PROYECTO), ]
rm(a,b,c,d,e,f,g,h,i,j,k,l,m,n, semifinal, dflist)
study_type<- table(final.geo$SERIES_TYPE)
study_type<- data.frame(study_type, stringsAsFactors = F)
names(study_type)[1] <-"series_type"
otrosdf<- data.frame(series_type = "Otros", Freq = sum(study_type == 1))
study_type <- data.frame(study_type[study_type$Freq >= 2, ])
study_type <- rbind(study_type, otrosdf)
study_type <- study_type[order(study_type$Freq, decreasing = F), ]
labls <- study_type$series_type
study_type<-study_type[order(study_type$Freq, decreasing = T), ]
library(ggplot2)
library(scales)
library(plyr)
Tipo_de_experimento <- as.vector(study_type$series_type)
Freq<- study_type$Freq
series_type <- as.vector(study_type$series_type)
study_type <- data.frame(series_type, Freq)
porcentaje <- percent(Freq/sum(Freq))
bp <- ggplot(study_type, aes(x="", y=study_type$Freq, fill= study_type$series_type)) +
geom_bar(stat = "identity", width = 0.3) + scale_fill_brewer(palette = "Dark2")
bp
bp + geom_text( check_overlap = F)
bp + geom_text(porcentaje, check_overlap = F)
bp + geom_text(aes(porcentaje, check_overlap = F))
bp + geom_text(aes(label=porcentaje, check_overlap = F))
pie <- bp + coord_polar("y", start=0)
pie
pie + scale_fill_brewer(palette="Dark2") + geom_text(aes(y = frecs), label = porcentaje)
pie + scale_fill_brewer(palette="Dark2") + geom_text(aes(y = frecs), label = porcentaje)
pie
View(study_type)
study_type<- table(GEO$SERIES_TYPE)
setwd("Documentos/gits/GEO_project/R-Scripts/")
GEO<-read.csv(file="GEO_tablet.tsv", header = T, sep = "\t", na.strings = "", stringsAsFactors = F)
Hs<- GEO[grep("Homo_sapiens", GEO$ORGANISMO), ]
a<-Hs[grep("addiction", Hs$RESUMEN_DEL_PROYECTO), ]
b<-Hs[grep("Alcoholism", Hs$RESUMEN_DEL_PROYECTO), ]
c<-Hs[grep("OCD", Hs$RESUMEN_DEL_PROYECTO), ]
d<-Hs[grep("Brain", Hs$RESUMEN_DEL_PROYECTO), ]
e<-Hs[grep("Coccaine", Hs$RESUMEN_DEL_PROYECTO), ]
f<-Hs[grep("Drug_abuse", Hs$RESUMEN_DEL_PROYECTO), ]
g<-Hs[grep("Alcohol", Hs$RESUMEN_DEL_PROYECTO), ]
h<-Hs[grep("Reward", Hs$RESUMEN_DEL_PROYECTO), ]
i<-Hs[grep("Substance_related_disorders", Hs$RESUMEN_DEL_PROYECTO), ]
j<-Hs[grep("Neuroscience", Hs$RESUMEN_DEL_PROYECTO), ]
k<-Hs[grep("Dopamine", Hs$RESUMEN_DEL_PROYECTO), ]
l<-Hs[grep("Glutamate", Hs$RESUMEN_DEL_PROYECTO), ]
m<-Hs[grep("Reward_mechanisms", Hs$RESUMEN_DEL_PROYECTO), ]
n<-Hs[grep("Alcohol_dependence", Hs$RESUMEN_DEL_PROYECTO), ]
dflist<- list(a,b,c,d,e,f,g,h,i,j,k,l,m,n)
semifinal <- do.call("rbind", dflist)
final.geo<-semifinal[!grepl("cancer", semifinal$RESUMEN_DEL_PROYECTO), ]
rm(a,b,c,d,e,f,g,h,i,j,k,l,m,n, semifinal, dflist)
study_type<- table(Hs$SERIES_TYPE)
study_type
View(study_type)
var<- subset.data.frame(Hs, select = c(Hs$ORGANISMO, Hs$SERIES_TYPE))
var
View(var)
var<- data.frame(Hs$ORGANISMO, Hs$SERIES_TYPE)
View(var)
table(var)
View(table(var))
nrow(1:Hs)
nrow(1:Hs)
FINAL.GEO <- GEO[0,]
INTERMEDIATE.DATAFRAME <- GEO[0,]
for(i in 1:nrow(Hs)){
INTERMEDIATE.DATAFRAME <- GEO[0,]
message(paste0("Operando sobre la linea ", i))
CELDA <- Hs$ORGANISMO[i]
ESPECIES <- unlist(strsplit(CELDA, split = ","))
#AQUI SE DEBE DE OPERAR SOBRE LA VARIABLE ESPECIES PARA ELIMINAR LOS
#ELEMENTOS QUE COMIENZAN CON "!Sample.." Y DESPUES CONTAR EL NUMERO DE ESPECIES
ESPECIES <- ESPECIES[!grepl('!Sample', ESPECIES)]
ESPECIES <- ESPECIES [!grepl('1:9', ESPECIES)]
NUMERO_DE_ESPECIES <- length(ESPECIES)
for (x in 1:NUMERO_DE_ESPECIES) {
INTERMEDIATE.DATAFRAME[x,] <- GEO[i,]
INTERMEDIATE.DATAFRAME[x,"ORGANISMO"] <- ESPECIES[x]
}
FINAL.GEO <- rbind(FINAL.GEO, INTERMEDIATE.DATAFRAME)
}
View(FINAL.GEO)
var<- data.frame(FINAL.GEO$ORGANISMO, FINAL.GEO$SERIES_TYPE)
View(var)
View(table(var))
