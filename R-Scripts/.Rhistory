biocLite("SRAdb")
source("https://bioconductor.org/biocLite.R")
biocLite("SRAdb")
source("https://bioconductor.org/biocLite.R")
biocLite("SRAdb")
install.packages("Rcpp")
vignette("SRAdb")
install.packages("Rcurl")
install.packages("RCurl")
install.packages("Rcpp")
install.packages("tibble")
install.packages("XML")
install.packages("GEOquery")
biocLite("GEOquery")
source("https://bioconductor.org/biocLite.R")
biocLite("GEOquery")
vignette(GEOquery)
q()
load("~/Documentos/sradb/SRAmetadb.sqlite")
load("~/Documentos/sradb/SRAmetadb.sqlite.gz")
load("~/Documentos/sradb/SRAmetadb.sqlite")
load("~/Documentos/sradb/SRAmetadb.sqlite.gz")
library(SRAdb)
source("https://bioconductor.org/biocLite.R")
biocLite("BiocUpgrade")
installed.packages()
installed.packages(lib.loc = )
library(SRAdb)
sra_dbname <- 'SRAmetadb.sqlite'
R --vanilla
library(SRAdb)
biocLite("BiocUpgrade")
source("https://bioconductor.org/biocLite.R")
biocLite("BiocUpgrade")
ggplot(as.data.frame(UCBAdmissions),
aes(weight = Freq, axis1 = Gender, axis2 = Dept)) +
geom_alluvium(aes(fill = Admit), width = 1/12) +
geom_stratum(width = 1/12, fill = "black", color = "grey") +
geom_label(stat = "stratum", label.strata = TRUE) +
scale_x_continuous(breaks = 1:2, labels = c("Gender", "Dept")) +
ggtitle("UC Berkeley admissions and rejections, by sex and department")
library("ggplot")
library(ggplot2)
ggplot(as.data.frame(UCBAdmissions),
aes(weight = Freq, axis1 = Gender, axis2 = Dept)) +
geom_alluvium(aes(fill = Admit), width = 1/12) +
geom_stratum(width = 1/12, fill = "black", color = "grey") +
geom_label(stat = "stratum", label.strata = TRUE) +
scale_x_continuous(breaks = 1:2, labels = c("Gender", "Dept")) +
ggtitle("UC Berkeley admissions and rejections, by sex and department")
install.packages("ggalluvial")
library(alluvial)
help("alluvial")
vignette(alluvial)
vignette("alluvial")
setwd("Documentos/gits/GEO_project/R-Scripts/")
GEO<-read.csv(file="GEO_tablet.tsv", header = T, sep = "\t", na.strings = "", stringsAsFactors = F)
Hs<- GEO[grep("Homo_sapiens", GEO$ORGANISMO), ]
a<-Hs[grep("addiction", Hs$RESUMEN_DEL_PROYECTO), ]
b<-Hs[grep("Alcoholism", Hs$RESUMEN_DEL_PROYECTO), ]
c<-Hs[grep("OCD", Hs$RESUMEN_DEL_PROYECTO), ]
d<-Hs[grep("Brain", Hs$RESUMEN_DEL_PROYECTO), ]
e<-Hs[grep("Coccaine", Hs$RESUMEN_DEL_PROYECTO), ]
f<-Hs[grep("Drug_abuse", Hs$RESUMEN_DEL_PROYECTO), ]
g<-Hs[grep("Alcohol", Hs$RESUMEN_DEL_PROYECTO), ]
h<-Hs[grep("Reward", Hs$RESUMEN_DEL_PROYECTO), ]
i<-Hs[grep("Substance_related_disorders", Hs$RESUMEN_DEL_PROYECTO), ]
j<-Hs[grep("Neuroscience", Hs$RESUMEN_DEL_PROYECTO), ]
k<-Hs[grep("Dopamine", Hs$RESUMEN_DEL_PROYECTO), ]
l<-Hs[grep("Glutamate", Hs$RESUMEN_DEL_PROYECTO), ]
m<-Hs[grep("Reward_mechanisms", Hs$RESUMEN_DEL_PROYECTO), ]
n<-Hs[grep("Alcohol_dependence", Hs$RESUMEN_DEL_PROYECTO), ]
dflist<- list(a,b,c,d,e,f,g,h,i,j,k,l,m,n)
semifinal <- do.call("rbind", dflist)
final.geo<-semifinal[!grepl("cancer", semifinal$RESUMEN_DEL_PROYECTO), ]
rm(a,b,c,d,e,f,g,h,i,j,k,l,m,n, semifinal, dflist, GEO)
var<- data.frame(final.geo$ORGANISMO, final.geo$SERIES_TYPE)
View(var)
View(table(var$final.geo.ORGANISMO))
View(table(var$final.geo.SERIES_TYPE))
rep("Homo_sapiens")
rep("Homo_sapiens", times= 3)
vst <- data.frame(table(var$final.geo.SERIES_TYPE))
vst
otrosvst <- vst[0,]
otrosvst
vst < vst[ =>2]
vst < vst[vst$Freq >= 2]
vst < vst[vst$Freq >= 2,]
vst < vst[,vst$Freq >= 2]
vst < vst[vst$Freq =<2]
vst < vst[vst$Freq <=2, ]
vst < vst$Freq[vst$Freq <=2, ]
vst < vst$Freq<=2
vst < vst$Freq <= 2
vst < data.frame(vst, vst$Freq >=2)
vst < data.frame(vst, vst$Freq >= 2)
vst < subset.data.frame(vst, vst$Freq >= 2)
View(vst)
vst[vst$Freq<=2,]
vst[vst$Freq>=2,]
vst<-vst[vst$Freq>=2,]
vst
otrosvst<-sum(vst$Freq==1)
otrosvst
otrosvst <- vst[0,]
otrosvst
otrosvst<-vst[sum(vst$Freq==1,)]
otrosvst<-vst[sum(vst$Freq==1),]
otrosvst
View(otrosvst)
otrosvst<-vst[vst$Freq==1,]
otrosvst
vst<-vst[vst$Freq>=2,]
vst<-vst[vst$Freq>=2,]
vst
otrosvst
otrosvst
otrosvst
otrosvst<-vst[vst$Freq==1,]
otrosvst
var<- data.frame(final.geo$ORGANISMO, final.geo$SERIES_TYPE)
vst <- data.frame(table(var$final.geo.SERIES_TYPE))
vst
vst2<-vst[vst$Freq>=2,]
otrosvst <- vst[0,]
otrosvst<-vst[vst$Freq==1,]
otrosvst
otrosvst<-sum(vst[vst$Freq==1,])
otrosvst<-vst[sum(vst$Freq==1),]
otrosvst
var<- data.frame(final.geo$ORGANISMO, final.geo$SERIES_TYPE)
vst <- data.frame(table(var$final.geo.SERIES_TYPE))
vst2<-vst[vst$Freq>=2,]
otrosvst <- vst[0,]
otrosvst<-vst[sum(vst$Freq==1),]
otrosvst
var<- data.frame(final.geo$ORGANISMO, final.geo$SERIES_TYPE)
vst <- data.frame(table(var$final.geo.SERIES_TYPE))
vst2<-vst[vst$Freq>=2,]
otrosvst <- vst[0,]
otrosvst<-vst[vst$Freq==1,]
otrosvst
vst <- data.frame(table(var$final.geo.SERIES_TYPE))
human<- rep("Homo_sapiens", times=15)
human
human<- data.frame(rep("Homo_sapiens", times=15))
human
bind_cols(human, vst)
rcols(human, vst)
rbind(human, vst)
bind_cols(human, vst)
library(alluvial)
library(plyr)
library(dplyr)
bind_cols(human, vst)
View(bind_cols(human, vst))
final.final.geo<-bind_cols(human, vst)
final.final.geo
order(final.final.geo)
order(final.final.geo, decreasing = T)
View(order(final.final.geo, decreasing = T))
VAR4<-bind_cols(human, vst)
names(VAR4)[1] <-"ORGANISMO"
names(VAR4)[2] <-"SERIES_TYPE"
names(VAR4)[3] <-"FREQ"
VAR4<-VAR4[order(VAR4$ORGANISMO),]
View(VAR4)
VAR4<-VAR4[order(VAR4$FREQ),]
View(VAR4)
VAR4<-VAR4[order(VAR4$FREQ, decreasing = T),]
View(VAR4)
VAR4 %>% group_by(VAR4$ORGANISMO, VAR4$SERIES_TYPE) %>%
summarise(n = sum(VAR4$FREQ)) -> VAR4D
alluvial(VAR4D[,1:2], freq=VAR34$n, col = "steelblue")
alluvial(VAR4D[,1:2], freq=VAR4$n, col = "steelblue")
VAR4 %>% group_by(VAR4$ORGANISMO, VAR4$SERIES_TYPE) %>%
summarise(n = sum(VAR4$FREQ)) -> VAR4D
alluvial(VAR4D[,1:2], freq=VAR4$n, col = "steelblue")
VAR4 %>% group_by(VAR4$ORGANISMO, VAR4$SERIES_TYPE) %>%
summarise(n = sum(VAR4$FREQ)) -> VAR4D
alluvial(VAR4D[,1:2], freq=VAR4$n, col = "steelblue")
VAR4<-data.frame(VAR4[order(VAR4$FREQ, decreasing = T),], stringsAsFactors = F)
VAR4 %>% group_by(VAR4$ORGANISMO, VAR4$SERIES_TYPE) %>%
summarise(n = sum(VAR4$FREQ)) -> VAR4D
alluvial(VAR4D[,1:2], freq=VAR4$n, col = "steelblue")
var<- data.frame(final.geo$ORGANISMO, final.geo$SERIES_TYPE)
vst <- data.frame(table(var$final.geo.SERIES_TYPE))
vst2<-vst[vst$Freq>=2,]
human<- data.frame(rep("Homo_sapiens", times=15))
VAR4<-bind_cols(human, vst)
names(VAR4)[1] <-"ORGANISMO"
names(VAR4)[2] <-"SERIES_TYPE"
names(VAR4)[3] <-"FREQ"
VAR4<-data.frame(VAR4, stringsAsFactors = F)
VAR4 %>% group_by(VAR4$ORGANISMO, VAR4$SERIES_TYPE) %>%
summarise(n = sum(VAR4$FREQ)) -> VAR4D
alluvial(VAR4D[,1:2], freq=VAR4$n, col = "steelblue")
alluvial(VAR4D[,1:2], freq=VAR4D$n, col = "steelblue")
alluvial(VAR4D[,1:2], freq=VAR4D$n, col = "green")
alluvial(VAR4D[,1:2], freq=VAR4D$n, col = "grass")
alluvial(VAR4D[,1:2], freq=VAR4D$n, col = "green")
VAR4D[,1:2]
View(VAR4D)
alluvial(VAR4D[,1:2], freq=VAR4$FREQ, col = "green")
alluvial(VAR4D[,1:2], freq=VAR4$FREQ, col = "grey", border = "white")
var<- data.frame(final.geo$ORGANISMO, final.geo$SERIES_TYPE, stringsAsFactors = F)
var <-as.data.frame(table(var), stringsAsFactors = F)
names(var)[1] <-"ORGANISMO"
names(var)[2] <-"SERIES_TYPE"
names(var)[3] <-"FREQ"
var[0,]
var %>% group_by(var$ORGANISMO, var$SERIES_TYPE) %>%
summarise(n = sum(var$FREQ)) -> tit2d
alluvial(tit2d[,1:2], freq=tit2d$n)
FINAL.VAR <- var[0,]
for(i in 1:nrow(var)){
INTERMEDIATE.DATAFRAME <- var[0,]
message(paste0("operando sobre la lÃ­nea ", i))
CELDA <-var$ORGANISMO[i]
ESPECIES <-unlist(strsplit(CELDA, split = ","))
ESPECIES <- ESPECIES[!grepl('!Sample', ESPECIES)]
ESPECIES <- ESPECIES [!grepl('1:9', ESPECIES)]
NUMERO_DE_ESPECIES <- length(ESPECIES)
for (x in 1:NUMERO_DE_ESPECIES) {
INTERMEDIATE.DATAFRAME[x,] <- var[i,]
INTERMEDIATE.DATAFRAME[x,"ORGANISMO"] <- ESPECIES[x]
}
FINAL.VAR <- rbind(FINAL.VAR, INTERMEDIATE.DATAFRAME)
}
rm(INTERMEDIATE.DATAFRAME)
View(table(FINAL.VAR))
FINAL.VAR<- as.data.frame(FINAL.VAR)
VAR2<-data.frame(FINAL.VAR$ORGANISMO, FINAL.VAR$SERIES_TYPE)
VAR2 <-as.data.frame(table(VAR2), stringsAsFactors = F)
names(VAR2)[1] <-"ORGANISMO"
names(VAR2)[2] <-"SERIES_TYPE"
names(VAR2)[3] <-"FREQ"
VAR2 %>% group_by(VAR2$ORGANISMO, VAR2$SERIES_TYPE) %>%
summarise(n = sum(VAR2$FREQ)) -> tit2d
alluvial(tit2d[,1:2], freq=tit2d$n, col = "steelblue")
alluvial(tit2d[,1:2], freq=VAR2$FREQ, col = "steelblue")
alluvial(VAR4D[,1:2], freq=VAR4$FREQ, col = "grey", border = "white")
alluvial(VAR4D[,1:2], freq=VAR4$FREQ, col = "steelblue", border = "white")
VAR4<-data.frame(VAR4[VAR4, order(VAR4$FREQ))], stringsAsFactors = F)
VAR4<-data.frame(VAR4[VAR4, order(VAR4$FREQ)], stringsAsFactors = F)
VAR4<-data.frame(VAR4[order(VAR4$FREQ), ], stringsAsFactors = F)
View(VAR4)
VAR4<-data.frame(VAR4[order(VAR4$FREQ, decreasing = T), ], stringsAsFactors = F)
View(VAR4)
VAR4 %>% group_by(VAR4$ORGANISMO, VAR4$SERIES_TYPE) %>%
summarise(n = sum(VAR4$FREQ)) -> VAR4D
alluvial(VAR4D[,1:2], freq=VAR4$FREQ, col = "steelblue", border = "white")
bp <- ggplot(study_type, aes(x="", y=study_type$Freq, fill= study_type$series_type)) +
geom_bar(stat = "identity", width = 0.3) + scale_fill_brewer(palette = "Dark2")
library(ggplot2)
library(scales)
library(plyr)
Tipo_de_experimento <- as.vector(study_type$series_type)
study_type<- table(Hs$SERIES_TYPE)
study_type<- data.frame(study_type, stringsAsFactors = F)
names(study_type)[1] <-"series_type"
otrosdf<- data.frame(series_type = "Otros", Freq = sum(study_type == 1))
study_type <- data.frame(study_type[study_type$Freq >= 2, ])
study_type <- rbind(study_type, otrosdf)
study_type <- study_type[order(study_type$Freq, decreasing = F), ]
labls <- study_type$series_type
study_type<-study_type[order(study_type$Freq, decreasing = T), ]
library(ggplot2)
library(scales)
library(plyr)
Tipo_de_experimento <- as.vector(study_type$series_type)
Freq<- study_type$Freq
series_type <- as.vector(study_type$series_type)
study_type <- data.frame(series_type, Freq)
porcentaje <- percent(Freq/sum(Freq))
bp <- ggplot(study_type, aes(x="", y=study_type$Freq, fill= study_type$series_type)) +
geom_bar(stat = "identity", width = 0.3) + scale_fill_brewer(palette = "Dark2")
bp + geom_text(aes(label=porcentaje, check_overlap = F))
